FROM node:20-alpine
WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm ci --omit=dev

# Copy server files
COPY server/ ./server/

# Data directory for carpet state persistence
RUN mkdir -p /app/data
ENV DATA_DIR=/app/data

# AI Motif — Gemini Native Image Generation
# GEMINI_API_KEY ortam değişkeni olarak verilmeli
ENV GEMINI_API_KEY=""

EXPOSE 3003
CMD ["node", "server/index.js"]
